# 认证接口文档

## 1. 微信用户登录

### 接口地址
`POST /api/auth/wechat/login`

### 请求参数
```json
{
  "code": "wx_temp_code_123",
  "encryptedData": "encrypted_user_data",
  "iv": "initialization_vector"
}
```

### 响应示例
```json
{
  "code": 200,
  "msg": "Login successful",
  "data": {
    "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
    "user_id": "user_123456",
    "role": "customer",
    "expires_in": 7200,
    "user_info": {
      "nickname": "张三",
      "avatar": "https://wx.qlogo.cn/...",
      "phone": "138****5678"
    }
  },
  "timestamp": "2025-07-16T10:30:00Z"
}
```

## 2. 司机注册

### 接口地址
`POST /api/auth/driver/register`

### 请求头
```
Authorization: Bearer <token>
```

### 请求参数
```json
{
  "license_number": "330100199001011234",
  "license_image": "data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQ...",
  "name": "李四",
  "phone": "139****8765"
}
```

### 响应示例
```json
{
  "code": 200,
  "msg": "Driver registration submitted",
  "data": {
    "status": "pending",
    "driver_id": "review_123456",
    "estimated_review_time": "24小时内"
  },
  "timestamp": "2025-07-16T10:30:00Z"
}
```

## 3. 管理员登录

### 接口地址
`POST /api/auth/admin/login`

### 请求参数
```json
{
  "phone": "13800138000",
  "password": "admin123456"
}
```

### 响应示例
```json
{
  "code": 200,
  "msg": "Admin login successful",
  "data": {
    "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
    "user_id": "admin_001",
    "role": "admin",
    "expires_in": 7200,
    "permissions": [
      "user_manage",
      "vehicle_audit",
      "order_manage"
    ]
  },
  "timestamp": "2025-07-16T10:30:00Z"
}

## 5. 司机信息审核列表

### 接口地址
`GET /api/admin/driver/reviews`

### 请求头
```
Authorization: Bearer <admin_token>
```

### 请求参数
| 参数名 | 类型 | 必填 | 说明 |
|--------|------|------|------|
| page | int | 否 | 页码，默认为1 |
| page_size | int | 否 | 每页数量，默认为10 |
| status | string | 否 | 状态筛选 (pending, approved, rejected) |
| action_type | string | 否 | 操作类型筛选 (register, update) |

### 响应示例
```json
{
  "code": 200,
  "msg": "Success",
  "data": {
    "list": [
      {
        "id": 1,
        "created_at": "2025-07-16T10:30:00Z",
        "updated_at": "2025-07-16T10:30:00Z",
        "open_id": "openid_123",
        "license_number": "330100199001011234",
        "name": "李四",
        "phone": "139****8765",
        "license_image_url": "https://example.com/license.jpg",
        "status": "pending",
        "comment": "",
        "action_type": "register",
        "driver_id": 0
      }
    ],
    "total": 1,
    "page": 1,
    "page_size": 10
  },
  "timestamp": "2025-07-16T10:30:00Z"
}
```

## 6. 获取司机审核详情

### 接口地址
`GET /api/admin/driver/review/{id}`

### 请求头
```
Authorization: Bearer <admin_token>
```

### 响应示例
```json
{
  "code": 200,
  "msg": "Success",
  "data": {
    "id": 1,
    "created_at": "2025-07-16T10:30:00Z",
    "updated_at": "2025-07-16T10:30:00Z",
    "open_id": "openid_123",
    "license_number": "330100199001011234",
    "name": "李四",
    "phone": "139****8765",
    "license_image_url": "https://example.com/license.jpg",
    "status": "pending",
    "comment": "",
    "action_type": "register",
    "driver_id": 0
  },
  "timestamp": "2025-07-16T10:30:00Z"
}
```

## 7. 批准司机审核

### 接口地址
`POST /api/admin/driver/review/{id}/approve`

### 请求头
```
Authorization: Bearer <admin_token>
```

### 请求参数
```json
{
  "comment": "审核通过"
}
```

### 响应示例
```json
{
  "code": 200,
  "msg": "Success",
  "data": null,
  "timestamp": "2025-07-16T10:30:00Z"
}
```

## 8. 拒绝司机审核

### 接口地址
`POST /api/admin/driver/review/{id}/reject`

### 请求头
```
Authorization: Bearer <admin_token>
```

### 请求参数
```json
{
  "comment": "驾照信息不清晰，请重新上传"
}
```

### 响应示例
```json
{
  "code": 200,
  "msg": "Success",
  "data": null,
  "timestamp": "2025-07-16T10:30:00Z"
}
```
```

## 4. 刷新令牌

### 接口地址
`POST /api/auth/refresh`

### 请求头
```
Authorization: Bearer <token>
```

### 请求参数
```json
{
  "refresh_token": "refresh_token_string"
}
```

### 响应示例
```json
{
  "code": 200,
  "msg": "Token refreshed successfully",
  "data": {
    "token": "new_jwt_token",
    "expires_in": 7200
  },
  "timestamp": "2025-07-16T10:30:00Z"
}